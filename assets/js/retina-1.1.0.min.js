/*
 * Retina.js v1.1.0
 *
 * Copyright 2013 Imulus, LLC
 * Released under the MIT license
 *
 * Retina.js is an open source script that makes it easy to serve
 * high-resolution images to devices with retina displays.
 */
(function(){var d=(typeof exports=="undefined"?window:exports);var a={check_mime_type:true};d.Retina=c;function c(){}c.configure=function(g){if(g==null){g={}}for(var f in g){a[f]=g[f]}};c.init=function(f){if(f==null){f=d}var g=f.onload||new Function;f.onload=function(){var h=document.getElementsByTagName("img"),l=[],j,k;for(j=0;j<h.length;j++){k=h[j];l.push(new b(k))}g()}};c.isRetina=function(){var f="(-webkit-min-device-pixel-ratio: 1.5),                      (min--moz-device-pixel-ratio: 1.5),                      (-o-min-device-pixel-ratio: 3/2),                      (min-resolution: 1.5dppx)";if(d.devicePixelRatio>1){return true}if(d.matchMedia&&d.matchMedia(f).matches){return true}return false};d.RetinaImagePath=e;function e(g,f){this.path=g;if(typeof f!=="undefined"&&f!==null){this.at_2x_path=f;this.perform_check=false}else{this.at_2x_path=g.replace(/\.\w+$/,function(h){return"@2x"+h});this.perform_check=true}}e.confirmed_paths=[];e.prototype.is_external=function(){return !!(this.path.match(/^https?\:/i)&&!this.path.match("//"+document.domain))};e.prototype.check_2x_variant=function(h){var g,f=this;if(this.is_external()){return h(false)}else{if(!this.perform_check&&typeof this.at_2x_path!=="undefined"&&this.at_2x_path!==null){return h(true)}else{if(this.at_2x_path in e.confirmed_paths){return h(true)}else{g=new XMLHttpRequest;g.open("HEAD",this.at_2x_path);g.onreadystatechange=function(){if(g.readyState!=4){return h(false)}if(g.status>=200&&g.status<=399){if(a.check_mime_type){var i=g.getResponseHeader("Content-Type");if(i==null||!i.match(/^image/i)){return h(false)}}e.confirmed_paths.push(f.at_2x_path);return h(true)}else{return h(false)}};g.send()}}}};function b(g){this.el=g;this.path=new e(this.el.getAttribute("src"),this.el.getAttribute("data-at2x"));var f=this;this.path.check_2x_variant(function(h){if(h){f.swap()}})}d.RetinaImage=b;b.prototype.swap=function(h){if(typeof h=="undefined"){h=this.path.at_2x_path}var f=this;function g(){if(!f.el.complete){setTimeout(g,5)}else{if(f.el.offsetWidth&&f.el.offsetHeight){f.el.setAttribute("width",f.el.offsetWidth);f.el.setAttribute("height",f.el.offsetHeight)}f.el.setAttribute("src",h)}}g()};if(c.isRetina()){c.init(d)}})();